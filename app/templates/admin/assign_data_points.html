<!-- // templates/admin/assign_data_points.html -->
{% extends "base.html" %}

{% block content %}
<div class="assign-data-points-container">
    <h1>Data Points Management</h1>
    
    <!-- Main view showing selected data points -->
    <div class="selected-data-points">
        <button id="openAssignModal" class="btn btn-primary">Select Data Points</button>
        
        <div class="selected-points-display">
            <h2>Selected Data Points</h2>
            <div class="accordion" id="dataPointsAccordion">
                <!-- Data points with collapsible panels will be added here dynamically -->
            </div>
        </div>
    </div>

    <!-- Modal for selecting data points -->
    <div id="assignModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Select Data Points</h2>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="selector-container">
                    <!-- Framework and fields selection -->
                    <div class="framework-section">
                        <div class="framework-selector">
                            <label for="framework_select">Select Framework:</label>
                            <select id="framework_select" class="form-control">
                                <option value="">Choose Framework</option>
                                {% for framework in frameworks %}
                                    <option value="{{ framework.framework_id }}">{{ framework.framework_name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        
                        <div class="available-fields" id="availableFields">
                            <!-- Fields will be populated dynamically -->
                        </div>
                    </div>

                    <!-- Selected data points -->
                    <div class="selected-section">
                        <h3>Selected Data Points</h3>
                        <div class="selected-fields" id="selectedFields">
                            <!-- Selected fields will appear here -->
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="confirmDataPoints" class="btn btn-primary">Confirm Selection</button>
                <button class="btn btn-secondary close-modal">Cancel</button>
            </div>
        </div>
    </div>
</div>

<!-- Add styles for the new configuration controls -->
<style>
.fy-frequency-config {
    background-color: #f8f9fa;
    border: 1px solid #dee2e6;
    border-radius: 0.375rem;
    padding: 1rem;
    margin-bottom: 1rem;
}

.fy-frequency-config h5 {
    color: #495057;
    margin-bottom: 0.75rem;
}

.config-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    margin-bottom: 1rem;
}

.config-field {
    display: flex;
    flex-direction: column;
}

.config-field label {
    font-weight: 500;
    margin-bottom: 0.25rem;
    color: #495057;
}

.config-field select,
.config-field input {
    padding: 0.375rem 0.75rem;
    border: 1px solid #ced4da;
    border-radius: 0.25rem;
    font-size: 0.875rem;
}

.fy-display {
    background-color: #e9ecef;
    padding: 0.5rem;
    border-radius: 0.25rem;
    font-size: 0.875rem;
    color: #495057;
    text-align: center;
}

.frequency-badge {
    display: inline-block;
    padding: 0.25rem 0.5rem;
    background-color: #007bff;
    color: white;
    border-radius: 0.25rem;
    font-size: 0.75rem;
    font-weight: 500;
}
</style>
{% endblock %}

{% block extra_head %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='css/admin/assign_data_points.css') }}">
{% endblock %}

{% block afterbody %}
<script type="module">
    import { PopupManager } from "{{ url_for('static', filename='js/common/popup.js') }}";
    window.PopupManager = PopupManager;
</script>
<script src="{{ url_for('static', filename='js/admin/assign_data_points.js') }}"></script>
{% endblock %}
